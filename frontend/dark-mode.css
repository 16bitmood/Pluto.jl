@media (prefers-color-scheme: dark) {
    /* From Pocket-Titan/DarkMode.jl */

    body {
        background-color: hsl(0, 0%, 15%);
    }
    body > header,
    footer,
    pluto-helpbox > header {
        background-color: hsl(0, 0%, 8%);
        color: hsl(0, 0%, 90%);
    }
    body > header * {
        color: white;
    }
    preamble {
        filter: invert(1);
    }
    nav#at_the_top img {
        filter: invert(1) hue-rotate(180deg) brightness(0.8) saturate(1.1);
    }
    nav#at_the_top button.toggle_export,
    nav#undo_delete {
        filter: invert(1);
    }
    body.disconnected > header {
        background-color: hsla(18, 35%, 47%, 50%);
    }
    pluto-input > button {
        filter: invert(1);
    }
    pluto-output {
        background-color: hsl(229, 5%, 10%);
        color: hsl(0, 0%, 90%);
    }
    pluto-output h1,
    pluto-output h2,
    pluto-output h3,
    pluto-output h4,
    pluto-output h5,
    pluto-output h6 {
        color: hsl(0, 0%, 90%);
    }
    pluto-output code {
        color: hsl(0, 0%, 80%);
    }
    pluto-output a {
        filter: invert(1);
    }
    pluto-output jltree,
    jltree *,
    jltree * * {
        filter: brightness(5);
    }
    nav#at_the_top img {
        filter: invert(1) hue-rotate(180deg) contrast(0.85);
    }
    jlerror > header {
        color: hsl(348, 40%, 90%);
    }
    pluto-filepicker .cm-s-material-palenight .cm-operator {
        color: #ff3b00;
    }
    jltree::before,
    jltree::after {
        filter: invert(1);
    }
    header.show_export header,
    header.show_export b {
        color: initial;
    }
    cell > button,
    cellinput > button,
    runarea > button,
    cellshoulder > button,
    slide-controls > button {
        color: white;
    }
    pluto-shoulder > button > span::after,
    pluto-cell.code_folded > pluto-shoulder > button > span::after {
        filter: invert(1);
    }
    pluto-cell > button {
        filter: invert(1);
    }
    cell.running > trafficlight {
        background: repeating-linear-gradient(
            -45deg,
            hsla(20, 20%, 80%, 1),
            hsla(20, 20%, 80%, 1) 8px,
            hsla(20, 20%, 80%, 0.1) 8px,
            hsla(20, 20%, 80%, 0.1) 16px
        );
    }
    cell.running.error > trafficlight {
        background: repeating-linear-gradient(-45deg, hsl(0, 100%, 71%), hsl(0, 100%, 71%) 8px, hsla(12, 71%, 47%, 0.33) 8px, hsla(12, 71%, 47%, 0.33) 16px);
    }
    pluto-runarea {
        filter: invert(1) brightness(1.9) contrast(1);
    }
    pluto-helpbox {
        color: hsl(0, 0%, 90%);
        background-color: hsl(0, 0%, 10%);
    }
    pluto-helpbox div.markdown pre {
        border: none !important;
    }
    pluto-helpbox div.markdown a {
        color: inherit;
    }
    pluto-helpbox header button {
        filter: invert(1);
    }
    footer a {
        color: hsl(0, 0%, 95%);
    }
    footer input {
        background-color: hsl(0, 0%, 13%);
        color: hsl(0, 0%, 85%);
    }
    /* Table stylings, credits to: https://github.com/zuckberj */
    /* for the fixed header */
    table.pluto-table .schema-names th,
    table.pluto-table .schema-types th:first-child {
        background-color: inherit;
    }
    /* for the rows numbers */
    table.pluto-table tbody th:first-child {
        background-color: inherit;
    }
    /* for the hovering header*/
    table.pluto-table .schema-types th {
        background-color: inherit;
        color: hsl(0, 0%, 90%);
    }
    table.pluto-table {
        border: 2px solid hsla(0, 0%, 100%, 0.2);
        border-left: none;
        border-right: none;
    }
    table.pluto-table .schema-types th {
        border-bottom: 1px solid hsla(0, 0%, 100%, 0.2);
    }
    /* Custom scrollbar */
    *::-webkit-scrollbar {
        width: 14px !important;
    }
    *::-webkit-scrollbar-track {
        background-color: hsl(0, 0%, 10%) !important;
    }
    *::-webkit-scrollbar-thumb {
        box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3) !important;
        background-color: hsla(0, 0%, 17%) !important;
    }
    /* Based on Sublime Text's Monokai theme */

    .cm-s-default.cm-s-default.CodeMirror {
        background: #272822;
        color: #f8f8f2;
    }
    .cm-s-default.cm-s-default div.CodeMirror-selected {
        background: #49483e;
    }
    .cm-s-default.cm-s-default .CodeMirror-line::selection,
    .cm-s-default.cm-s-default .CodeMirror-line > span::selection,
    .cm-s-default.cm-s-default .CodeMirror-line > span > span::selection {
        background: rgba(73, 72, 62, 0.99);
    }
    .cm-s-default.cm-s-default .CodeMirror-line::-moz-selection,
    .cm-s-default.cm-s-default .CodeMirror-line > span::-moz-selection,
    .cm-s-default.cm-s-default .CodeMirror-line > span > span::-moz-selection {
        background: rgba(73, 72, 62, 0.99);
    }
    .cm-s-default.cm-s-default .CodeMirror-gutters {
        background: #272822;
        border-right: 0px;
    }
    .cm-s-default.cm-s-default .CodeMirror-guttermarker {
        color: white;
    }
    .cm-s-default.cm-s-default .CodeMirror-guttermarker-subtle {
        color: #d0d0d0;
    }
    .cm-s-default.cm-s-default .CodeMirror-linenumber {
        color: #d0d0d0;
    }
    .cm-s-default.cm-s-default .CodeMirror-cursor {
        border-left: 1px solid #f8f8f0;
    }

    .cm-s-default.cm-s-default span.cm-comment {
        color: #75715e;
    }
    .cm-s-default.cm-s-default span.cm-atom {
        color: #ae81ff;
    }
    .cm-s-default.cm-s-default span.cm-number {
        color: #ae81ff;
    }

    .cm-s-default.cm-s-default span.cm-comment.cm-attribute {
        color: #97b757;
    }
    .cm-s-default.cm-s-default span.cm-comment.cm-def {
        color: #bc9262;
    }
    .cm-s-default.cm-s-default span.cm-comment.cm-tag {
        color: #bc6283;
    }
    .cm-s-default.cm-s-default span.cm-comment.cm-type {
        color: #5998a6;
    }

    .cm-s-default.cm-s-default span.cm-property,
    .cm-s-default.cm-s-default span.cm-attribute {
        color: #a6e22e;
    }
    .cm-s-default.cm-s-default span.cm-keyword {
        color: #f92672;
    }
    .cm-s-default.cm-s-default span.cm-builtin {
        color: #66d9ef;
    }
    .cm-s-default.cm-s-default span.cm-string {
        color: #e6db74;
    }

    .cm-s-default.cm-s-default span.cm-variable {
        color: #f8f8f2;
    }
    .cm-s-default.cm-s-default span.cm-variable-2 {
        color: #9effff;
    }
    .cm-s-default.cm-s-default span.cm-variable-3,
    .cm-s-default.cm-s-default span.cm-type {
        color: #66d9ef;
    }
    .cm-s-default.cm-s-default span.cm-def {
        color: #fd971f;
    }
    .cm-s-default.cm-s-default span.cm-bracket {
        color: #f8f8f2;
    }
    .cm-s-default.cm-s-default span.cm-tag {
        color: #f92672;
    }
    .cm-s-default.cm-s-default span.cm-header {
        color: #ae81ff;
    }
    .cm-s-default.cm-s-default span.cm-link {
        color: #ae81ff;
    }
    .cm-s-default.cm-s-default span.cm-error {
        background: #f92672;
        color: #f8f8f0;
    }

    .cm-s-default.cm-s-default .CodeMirror-activeline-background {
        background: #373831;
    }
    .cm-s-default.cm-s-default .CodeMirror-matchingbracket {
        text-decoration: underline;
        color: white !important;
    }
}
